<?xml version="1.0" encoding="UTF-8"?><sqlb_project><db path="" readonly="0" foreign_keys="" case_sensitive_like="" temp_store="" wal_autocheckpoint="" synchronous=""/><attached/><window><main_tabs open="structure browser pragmas query" current="3"/></window><tab_structure><column_width id="0" width="300"/><column_width id="1" width="0"/><column_width id="2" width="100"/><column_width id="3" width="2628"/><column_width id="4" width="0"/></tab_structure><tab_browse><table title="." custom_title="0" dock_id="2" table="0,0:"/><dock_state state="000000ff00000000fd00000001000000020000000000000000fc0100000002fb000000160064006f0063006b00420072006f00770073006500310100000000ffffffff0000000000000000fb000000160064006f0063006b00420072006f00770073006500320100000000ffffffff0000012400ffffff000000000000000000000004000000040000000800000008fc00000000"/><default_encoding codec=""/><browse_table_settings/></tab_browse><tab_sql><sql name="SQL 1*">PRAGMA foreign_keys = ON;

/* Clean up */
DROP TABLE IF EXISTS artwork_genre;
DROP TABLE IF EXISTS artwork;
DROP TABLE IF EXISTS artist;
DROP TABLE IF EXISTS movement;
DROP TABLE IF EXISTS medium;
DROP TABLE IF EXISTS genre;
DROP TABLE IF EXISTS gallery;

/* Reference tables */
CREATE TABLE artist (
  artist_id     INTEGER PRIMARY KEY,
  name          TEXT NOT NULL,
  country       TEXT,
  birth_year    INTEGER,
  death_year    INTEGER
);

CREATE TABLE movement (
  movement_id   INTEGER PRIMARY KEY,
  name          TEXT NOT NULL UNIQUE
);

CREATE TABLE medium (
  medium_id     INTEGER PRIMARY KEY,
  name          TEXT NOT NULL UNIQUE
);

CREATE TABLE genre (
  genre_id      INTEGER PRIMARY KEY,
  name          TEXT NOT NULL UNIQUE
);

CREATE TABLE gallery (
  gallery_id    INTEGER PRIMARY KEY,
  name          TEXT NOT NULL,
  city          TEXT,
  country       TEXT
);

/* Fact table */
CREATE TABLE artwork (
  artwork_id    INTEGER PRIMARY KEY,
  title         TEXT NOT NULL,
  year          INTEGER,
  artist_id     INTEGER NOT NULL,
  movement_id   INTEGER,
  medium_id     INTEGER,
  gallery_id    INTEGER,
  price         NUMERIC,
  FOREIGN KEY (artist_id)  REFERENCES artist(artist_id),
  FOREIGN KEY (movement_id)REFERENCES movement(movement_id),
  FOREIGN KEY (medium_id)  REFERENCES medium(medium_id),
  FOREIGN KEY (gallery_id) REFERENCES gallery(gallery_id)
);

/* Junction table */
CREATE TABLE artwork_genre (
  artwork_id    INTEGER NOT NULL,
  genre_id      INTEGER NOT NULL,
  PRIMARY KEY (artwork_id, genre_id),
  FOREIGN KEY (artwork_id) REFERENCES artwork(artwork_id),
  FOREIGN KEY (genre_id)   REFERENCES genre(genre_id)
);

/* Seed data */
INSERT INTO artist (artist_id, name, country, birth_year, death_year) VALUES
 (1,'Leonardo da Vinci','Italy',1452,1519),
 (2,'Michelangelo','Italy',1475,1564),
 (3,'Vincent van Gogh','Netherlands',1853,1890),
 (4,'Claude Monet','France',1840,1926),
 (5,'Pablo Picasso','Spain',1881,1973),
 (6,'Salvador Dalí','Spain',1904,1989),
 (7,'Frida Kahlo','Mexico',1907,1954),
 (8,'Rembrandt van Rijn','Netherlands',1606,1669);

INSERT INTO movement (movement_id, name) VALUES
 (1,'Renaissance'),
 (2,'Baroque'),
 (3,'Impressionism'),
 (4,'Post-Impressionism'),
 (5,'Cubism'),
 (6,'Surrealism');

INSERT INTO medium (medium_id, name) VALUES
 (1,'Oil on canvas'),
 (2,'Tempera on panel'),
 (3,'Marble'),
 (4,'Fresco'),
 (5,'Acrylic on canvas'),
 (6,'Mixed media');

INSERT INTO genre (genre_id, name) VALUES
 (1,'Portrait'),
 (2,'Landscape'),
 (3,'Still Life'),
 (4,'Religious'),
 (5,'Abstract'),
 (6,'Historical');

INSERT INTO gallery (gallery_id, name, city, country) VALUES
 (1,'Louvre','Paris','France'),
 (2,'Uffizi Gallery','Florence','Italy'),
 (3,'Museo del Prado','Madrid','Spain'),
 (4,'MoMA','New York','USA'),
 (5,'Tate Modern','London','UK'),
 (6,'Rijksmuseum','Amsterdam','Netherlands');

/* Artworks */
INSERT INTO artwork (artwork_id, title, year, artist_id, movement_id, medium_id, gallery_id, price) VALUES
 (1,'Mona Lisa',1503,1,1,1,1,NULL),
 (2,'The Last Supper',1498,1,1,4,2,NULL),
 (3,'David',1504,2,1,3,2,NULL),
 (4,'The Night Watch',1642,8,2,1,6,80000000),
 (5,'Starry Night',1889,3,4,1,4,95000000),
 (6,'Sunflowers',1888,3,4,1,5,72000000),
 (7,'Water Lilies',1916,4,3,1,4,55000000),
 (8,'Les Demoiselles d''Avignon',1907,5,5,1,4,100000000),
 (9,'Guernica',1937,5,5,1,3,200000000),
 (10,'The Persistence of Memory',1931,6,6,1,4,65000000),
 (11,'The Two Fridas',1939,7,6,1,5,48000000),
 (12,'Self-Portrait with Thorn Necklace',1940,7,6,1,4,43000000),
 (13,'Impression, Sunrise',1872,4,3,1,5,60000000),
 (14,'Wheatfield with Crows',1890,3,4,1,6,70000000),
 (15,'The Creation of Adam',1512,2,1,4,2,NULL);

/* Artwork → Genres */
INSERT INTO artwork_genre (artwork_id, genre_id) VALUES
 (1,1),(1,6),
 (2,4),(2,6),
 (3,6),
 (4,6),(4,1),
 (5,2),(5,5),
 (6,3),
 (7,2),
 (8,5),
 (9,5),(9,6),
 (10,5),
 (11,1),
 (12,1),
 (13,2),
 (14,2),
 (15,4),(15,6);

/* ====== Queries for audit/screenshots ====== */

/* Q1: Artworks with details */
SELECT a.title, a.year,
       ar.name AS artist,
       m.name  AS movement,
       me.name AS medium,
       g.name  AS gallery, g.city, g.country
FROM artwork a
JOIN artist   ar ON ar.artist_id   = a.artist_id
LEFT JOIN movement m ON m.movement_id = a.movement_id
LEFT JOIN medium   me ON me.medium_id  = a.medium_id
LEFT JOIN gallery  g  ON g.gallery_id  = a.gallery_id
ORDER BY a.year;

/* Q2: Count artworks by movement */
SELECT m.name AS movement, COUNT(*) AS total_artworks
FROM artwork a
JOIN movement m ON m.movement_id = a.movement_id
GROUP BY m.name
ORDER BY total_artworks DESC;

/* Q3: Average price by movement (ignore NULL) */
SELECT m.name AS movement,
       ROUND(AVG(a.price),2) AS avg_price
FROM artwork a
JOIN movement m ON m.movement_id = a.movement_id
WHERE a.price IS NOT NULL
GROUP BY m.name
ORDER BY avg_price DESC;

/* Q4: Artworks at MoMA after 1900 */
SELECT a.title, a.year, ar.name AS artist
FROM artwork a
JOIN artist ar ON ar.artist_id = a.artist_id
JOIN gallery g ON g.gallery_id = a.gallery_id
WHERE g.name = 'MoMA' AND a.year &gt;= 1900
ORDER BY a.year;

/* Q5: Genres per artwork */
SELECT a.title,
       GROUP_CONCAT(g.name, ', ') AS genres
FROM artwork a
JOIN artwork_genre ag ON ag.artwork_id = a.artwork_id
JOIN genre g ON g.genre_id = ag.genre_id
GROUP BY a.title
ORDER BY a.title;

/* Q6: Artists with zero artworks */
SELECT ar.name
FROM artist ar
LEFT JOIN artwork a ON a.artist_id = ar.artist_id
WHERE a.artwork_id IS NULL;
</sql><current_tab id="0"/></tab_sql></sqlb_project>
